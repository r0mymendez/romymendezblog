---
title: "AWS Copilot"
description: |
  En el siguiente art√≠culo te cuento que es AWS Copilot, como se utiliza este proyecto y la facilidad de implementarlo.
categories:
  - Cloud Computing
preview: "preview.jpg"
twitter:
  site: "@r0mymendez"
  creator: "@r0mymendez"
author:
  - name: Romina Mendez
    url: https://r0mymendez.github.io/romymendezblog/
date: 10-06-2022
output:
  distill::distill_article:
    self_contained: yes
    toc: yes
editor_options: 
  markdown: 
    wrap: sentence
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

[![](https://img.shields.io/badge/Buy%20Me%20A%20Coffee-support%20my%20work-FFDD00?style=flat&labelColor=101010&logo=buy-me-a-coffee&logoColor=white){width="40%"}](https://www.buymeacoffee.com/r0mymendez)

En el presente articulo te explico el uso del servicio **AWS Copilot**, pero para poder realizarlo es necesario que comencemos analizando que es y como funciona el servicio de **ECS** (AWS Elastic Container Service) y sus formas de implementaci√≥n.
Esto es necesario debido a que AWS copilot realiza la implementaci√≥n y despliegue de una aplicaci√≥n utilizando ECS.

------------------------------------------------------------------------

# üí°AWS ECS (Elastic Container Services)

Elastic Container Service (**ECS**) es una plataforma de orquestaci√≥n de contenedores escalable propietaria de AWS y la misma fue dise√±ada para ejecutar, detener y administrar contenedores en un cl√∫ster.

Por lo cual podemos definir que ECS es el servicio de contenedores de AWS Docker que maneja la orquestaci√≥n y el aprovisionamiento de contenedores de Docker.

Este servicio contiene los siguientes conceptos:

-   **‚òÅÔ∏è Definici√≥n de tarea**: Describe c√≥mo se debe iniciar un contenedor docker.
-   **‚òÅÔ∏è Tarea**: este es un contenedor en ejecuci√≥n con la configuraci√≥n definida en la definici√≥n de tarea.
-   **‚òÅÔ∏è Servicio**: define tareas de ejecuci√≥n prolongada de la misma definici√≥n de tarea.
-   **‚òÅÔ∏è Cl√∫ster**: un grupo l√≥gico de instancias EC2.
-   **‚òÅÔ∏è Instancia de contenedor**: est√° es solo una instancia de EC2 que forma parte de un cl√∫ster de ECS y tiene docker.

## ‚öíÔ∏è ECS con instancias EC2

En este modelo, los contenedores se implementan en instancias EC2 (VM) creadas para el cl√∫ster.
ECS los administra junto con las tareas que forman parte de la definici√≥n de la tarea.

+----------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ‚úÖ Ventajas                                                                                               | ‚ùå Desventajas                                                                                                                                                                         |
+==========================================================================================================+=======================================================================================================================================================================================+
| -   Tiene control total sobre el tipo de instancia EC2 utilizada.                                        | -   Al trabajar con EC2 es necesario que todas las actualizaciones de seguridad de las instancias, como su escalamiento debe ser realizado por el administrador de esta arquitectura. |
+----------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| -   Permite poder utilizar instancias que pueden estar optimizadas dependiendo lo que se desee ejecutar. | -   Costo es en base al tipo de instancia EC2 que se ejecuta dentro del cl√∫ster y redes de VPC.                                                                                       |
+----------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

## ‚öíÔ∏è ECS con AWS Fargate (Serverless)

En esta variante ya no se utilizan instancias o servidores EC2.
Simplemente es necesario seleccionar la combinaci√≥n de CPU y memoria que necesita.

+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------+
| ‚úÖ Ventajas                                                                                                                                                        | ‚ùå Desventajas                                                                                                                                |
+===================================================================================================================================================================+==============================================================================================================================================+
| -   No hay servidores para administrar.                                                                                                                           | -   ECS + Fargate admite solo un modo de red y esto¬† limita su control sobre la capa de red                                                  |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------+
| -   AWS est√° a cargo de la disponibilidad y escalabilidad de los contenedores.                                                                                    | -   Costo es en funci√≥n de la CPU y la memoria que seleccione. La cantidad de n√∫cleos de CPU y GB determina el costo de ejecutar el cl√∫ster. |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------+
| -   Fargate Spot, es¬† una nueva capacidad que puede ejecutar tareas de ECS tolerantes a interrupciones con hasta un 70 % de descuento sobre el precio de Fargate. |                                                                                                                                              |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------+

# üí°**AWS Copilot**

**AWS Copilot** es una herramienta que se utiliza por la l√≠nea de comando de AWS y permite la simplificaci√≥n de la creaci√≥n, despliegue, control y operaci√≥n de contenedores en **ECS** utilizando un entorno de desarrollo local.¬†

Esta herramienta administra los componentes que son necesarios para el despliegue y el funcionamiento de una aplicaci√≥n tales como VPC, balanceadores de carga, flujos de implementaci√≥n y almacenamiento.
Por lo cual solo es necesario proporcionar un contenedor de la aplicaci√≥n y m√≠nimas configuraciones necesarias, dando como resultado una implementaci√≥n m√°s r√°pida y haciendo foco en el desarrollo de aplicaci√≥n.

## üîé Comparativa de tareas a realizar¬†

Ver como los servicios se van a comunicar entre s√≠, por lo cual hay que tener en cuenta los siguientes escenarios:

+--------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------+---------------------------------------------------------------------+
| Actividades                                                                                                  | SIN AWS-copilot                                                     | CON AWS-copilot                                                     |
+==============================================================================================================+=====================================================================+=====================================================================+
| <strong><font style="background-color:#FAFAFA;">Desarrollo de la aplicaci√≥n</font></strong>                  | <font style="background-color:#CDFECF;">Equipo de desarrollo</font> | <font style="background-color:#CDFECF;">Equipo de desarrollo</font> |
+--------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------+---------------------------------------------------------------------+
| <strong><font style="background-color:#FAFAFA;">Generaci√≥n del contenedor</font></strong>                    | <font style="background-color:#CDFECF;">Equipo de desarrollo</font> | <font style="background-color:#CDFECF;">Equipo de desarrollo</font> |
+--------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------+---------------------------------------------------------------------+
| <strong><font style="background-color:#FAFAFA;">Subredes de Virtual Private Cloud (VPC)</font></strong>      | <font style="background-color:#CDFECF;">Equipo de desarrollo</font> | <font style="background-color:#FFEDC4;">AWS-Copilot</font>          |
+--------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------+---------------------------------------------------------------------+
| <strong><font style="background-color:#FAFAFA;">Balanceadores de carga</font></strong>                       | <font style="background-color:#CDFECF;">Equipo de desarrollo</font> | <font style="background-color:#FFEDC4;">AWS-Copilot</font>          |
+--------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------+---------------------------------------------------------------------+
| <strong><font style="background-color:#FAFAFA;">Flujos de implementaci√≥n (ci/cd)</font></strong>             | <font style="background-color:#CDFECF;">Equipo de desarrollo</font> | <font style="background-color:#FFEDC4;">AWS-Copilot</font>          |
+--------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------+---------------------------------------------------------------------+
| <strong><font style="background-color:#FAFAFA;">Almacenamiento persistente de su aplicaci√≥n.</font></strong> | <font style="background-color:#CDFECF;">Equipo de desarrollo</font> | <font style="background-color:#FFEDC4;">AWS-Copilot</font>          |
+--------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------+---------------------------------------------------------------------+
| <strong><font style="background-color:#FAFAFA;">Sincronizar el despliegue en ambientes</font></strong>       | <font style="background-color:#CDFECF;">Equipo de desarrollo</font> | <font style="background-color:#FFEDC4;">AWS-Copilot</font>          |
+--------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------+---------------------------------------------------------------------+

## üß© Componentes

La siguiente tabla contiene los componentes que se configuran al utilizar el servicio de aws copilot.

+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
| **Componente**                                                             | **Descripci√≥n**                                                                         |
+============================================================================+=========================================================================================+
| <strong><font style="background-color:#CDFECF;">Aplicaci√≥n</font></strong> | \| Una aplicaci√≥n es un mecanismo de agrupaci√≥n de las piezas de su sistema.¬†           |
+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
| <strong><font style="background-color:#FFFFBC;">Ambiente</font></strong>   | Un ambiente es una etapa del despliegue de una aplicaci√≥n.¬†                             |
+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
| <strong><font style="background-color:#D7EFFF;">Servicio</font></strong>   | Un servicio es un proceso √∫nico de c√≥digo de larga ejecuci√≥n dentro de un contenedor.¬†¬† |
+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+

## ‚öíÔ∏è Instalaci√≥n y utilizaci√≥n¬†

En solo 5 pasos podemos implementar una aplicaci√≥n utilizando aws-copilot, como lo muestra la imagen siguiente.
Esto permite que el equipo de desarrollo solo haga foco en el desarrollo y no tanto en el despliegue de la infraestructura.

La primera aplicaci√≥n que se implemente en copilot realizar√° una configuraci√≥n predeterminada y la misma ser√° con un¬† contenedor serverless en fargate.

Como se observa en la siguiente imagen con solo 5 pasos ya podemos hacer un despliegue de una aplicaci√≥n.

![](aws_copilot_process.png)

Los pasos como se ven en el flujo son los siguientes:

1.  Instalamos <font style="background-color:#CDFECF;">AWS copilot</font> que va necesitar las credenciales del cliente de aws
2.  Creamos el <font style="background-color:#CDFECF;">Dockerfile</font> de nuesta aplicaci√≥n
3.  Ejecutamos en una terminal <font style="background-color:#CDFECF;">`copilot init`</font> para inicializar.
4.  Al ejecutar el init posteriormente van aparecer algunas preguntas para responder tales como: el <font style="background-color:#CDFECF;">`nombre de la aplicaci√≥n`</font> , <font style="background-color:#CDFECF;">`tipo de servicio`</font> , <font style="background-color:#CDFECF;">`nombre del servicio`</font> y <font style="background-color:#CDFECF;">`la ubicaci√≥n del dockerfile`</font>
5.  En este ultimo paso se va a retorna una <font style="background-color:#CDFECF;">URL</font> para poder acceder a la aplicaci√≥n.

## üîé Logs

Para obtener los logs de los contenedores desplegados, es necesario ejecutar el siguiente comando:

| \$ copilot svc logs- follow |
|-----------------------------|

## üìâ Tr√°fico a producci√≥n

Para hacer el despliegue en producci√≥n es necesario poder generar diferentes ambientes, por lo cual para generarlos es necesario ejecutar el siguiente comando**.**

| \$ copilot env init |
|---------------------|

Posteriormente es importante poder modificar el archivo de manifiesto que contiene todas las configuraciones de la aplicaci√≥n y el mismo se encuentra en ¬†nombredeaplicacion/**manifest.yml**

Una vez finalizada la configuraci√≥n del ambiente es necesario hacer el despliegue en producci√≥n (u otro ambiente, pero el siguiente ejemplo es en producci√≥n).

| \$ copilot svc deploy ---env production |
|-----------------------------------------|

## üß™Testing

Para poder hacer pruebas de la aplicaci√≥n desplegada, se puede utilizar apachebench el cual permite generar tr√°fico a la aplicaci√≥n web.

Para esto es necesario poder ejecutar el siguiente comando en el cual se desea generar un n√∫mero de 5000 transacciones a mi servicio con una concurrencia de 25 solicitudes a la vez.

| ab -n 5000 -c 25[\<http://app12345.us-east-1.elb.amazonaws.com\>](http://nyan-publi-wi97060djp1b-2041999651.us-east-1.elb.amazonaws.com/) |
|-------------------------------------------------------------------------------------------------------------------------------------------|

En el caso de no tener la respuesta esperada puedo modificar mi archivo de manifiesto y escalar horizontalmente la aplicaci√≥n en base a los diferentes ambientes.¬†

## üí∞Costos del servicio

Esta es una herramienta distribuida por Amazon bajo una licencia apache 2.0, por lo cual esto significa que es una aplicaci√≥n open source.

Al ser una aplicaci√≥n open source no tiene costos adicionales, el precio est√° dado por el uso de los servicios configurados.

# üéØConclusiones Finales

\
Realizando un breve resumen de AWS copilot podemos destacar las siguientes caracter√≠sticas:

-   **AWS Copilot** es una herramienta open source de AWS que permite implementar un contenedor listo para producci√≥n en solo <font style="background-color:#FFFFBC;">`5 pasos`</font>, permitiendo que el foco est√© en el desarrollo de la aplicaci√≥n y no tanto en la infraestructura.

-   Es <font style="background-color:#FFFFBC;">`simple de configurar`</font> , ya que solo es necesario la ejecuci√≥n de algunos comandos y modificar el archivo de manifiesto en base a los recursos que nuestra aplicaci√≥n necesita .

-   En el caso que se requiera un <font style="background-color:#FFFFBC;">`crecimiento horizontal`</font> solo se debe modificar el archivo de manifiesto y posteriormente se debe realizar el despliegue de la aplicaci√≥n.

-   AWS copilot permite configurar un <font style="background-color:#FFFFBC;">`pipeline de CI/CD`</font> para poder hacer despliegues entre ambientes de forma autom√°tica.

-   La generaci√≥n de <font style="background-color:#FFFFBC;">`KPI`</font> , <font style="background-color:#FFFFBC;">`alarmas`</font> y <font style="background-color:#FFFFBC;">`m√©tricas`</font> de la aplicaci√≥n se pueden obtener con pocos comandos utilizando el servicio de AWS-Copilot.

# üìöBibliograf√≠a

1.  üìö**T√≠tulo**: Presentamos AWS Copilot, Sitio: Blog de Amazon Web Services (AWS), **Autor**: Nathan Peck,Gabriel Gasca Torres y Jos√© Lorenzo Cu√©ncar, **url**: <https://aws.amazon.com/es/blogs/aws-spanish/presentamos-aws-copilot/>, **Fecha de consulta**:2022-09-17

2.  üìö**Titulo**: Introducci√≥n a Amazon ECS mediante AWS Copilot, **Sitio**: Documentaci√≥n oficical de AWS, **Autor**: AWS, **url**: <https://docs.aws.amazon.com/es_es/AmazonECS/latest/userguide/getting-started-aws-copilot-cli.html>, **Fecha de consulta**: 2022-09-17

3.  üìö**Titulo:** AWS Copilot**, Sitio:** AWS**, Autor:** AWS, **url**: <https://aws.amazon.com/es/containers/copilot/>, **Fecha de consulta**: 2022-09-17

4.  üìö**Titulo**: Gentle Introduction to How AWS ECS Works with Example Tutorial, **Sitio:** Medium**, Autor:** [Tung Nguyen](https://medium.com/@tongueroo?source=post_page-----cea3d27ce63d--------------------------------) **, Url:** <https://medium.com/boltops/gentle-introduction-to-how-aws-ecs-works-with-example-tutorial-cea3d27ce63d>, **Fecha de consulta**: 2022-09-17

------------------------------------------------------------------------

-   Image preview reference: [Image by vectorjuice on Freepik](https://www.freepik.com/free-vector/engineer-developer-with-laptop-tablet-code-cross-platform-development-cross-platform-operating-systems-software-environments-concept-pinkish-coral-bluevector-isolated-illustration_11669400.htm#query=develop%20illustration&position=28&from_view=search&track=ais&uuid=60430892-2126-4b0b-8e3c-8cd2b277ecab)
